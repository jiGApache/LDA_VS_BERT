 The classification of electrocardiogram signals is very important for the automatic diagnosis of heart disease. Traditionally, it is divided into two steps, including the step of feature extraction and the step of pattern classification. Owing to recent advances in artificial intelligence, it has been demonstrated that deep neural network, which trained on huge amount of data, can carry out the task of feature extraction directly from the data and recognize cardiac arrhythmias better than professional This paper proposes an ECG arrhythmia classification method using two-dimensional deep convolutional neural network . The time domain signals of ECG, belonging to five heart beat types including normal beat , left bundle branch block beat , right bundle branch block beat , premature ventricular contraction beat , and atrial premature contraction beat , were first transformed into time-frequency spectrograms short-time Fourier transform. Subsequently, the spectrograms of the five arrhythmia types were utilized as input to the such that the ECG arrhythmia types were identified and classified finally. Using ECG recordings from the MIT-BIH arrhythmia database as the training and testing data, the classification results show that the proposed model can reach an averaged accuracy of . On the other hand, in order to achieve optimal classification performances, the model parameter optimization was investigated. It was found when the learning rate is and the batch size parameter is the classifier achieved the highest accuracy and the lowest loss. We also compared the proposed model with conventional one-dimensional CNN model. Comparison results show that the classifier can achieve an averaged accuracy of . Therefore, it is validated that the proposed CNN classifier using ECG spectrograms as input can achieve improved classification accuracy without additional manual pre-processing of the ECG signals. INDEX TERMS Electrocardiogram ; arrhythmia classification; short-time Fourier transform ; convolutional neural network; model parameter optimization. I. INTRODUCTION Cardiovascular disease is one of the major diseases that threaten human life. According to reports the world health organization, cardiovascular diseases mortality ranks first in all causes of death today. Over million people died from CVDs, which is an about percentages of all deaths. More than percentages of these deaths occurred in developing countries. What’s more, the prevalence and mortality of cardiovascular disease are still growing . Therefore, regular monitoring of heart rhythm has become an increasingly important and necessary matter so as to manage and prevent the CVDs. Arrhythmia is an important group of diseases in cardiovascular disease. Arrhythmia can occur on its own or with other cardiovascular diseases. The diagnosis of arrhythmia mainly depends on the ECG . ECG is an important modern medical tool that records the process of cardiac excitability, transmission, and recovery. Automatic detection of irregular heart rhythms from ECG. Traditionally, the classification of ECG signals usually needs to be divided into two steps, i.e., feature extraction and pattern classification. Studies on detection concentrate on the problem of determining heartbeat within the ECG data, and some have been applied in heartbeat detection, including threshold-based methods , digital filter-based methods , , and wavelet transform – and so on. The pattern classification of detected ECG signals is another step. Wavelet transform is one of the commonly used methods for obtaining the features of ECG signals. Li used the wavelet packet decomposition technique to obtain representative features for the detection of five different heartbeat types, and calculate entropy from decomposed coefficients with WPD . Özbay computed detail and approximation wavelet coefficients of the ECG features to generate feature vectors . Li proposed novel method based on genetic algorithm-back propagation neural network for classifying ECG signals with feature extraction using wavelet packet decomposition . Other methods were also employed for extracting features from ECG signals. Elhaj extracted the linear and nonlinear features from the signals for automatic ECG beat recognition . Yeh used complex ECG feature extraction technique to classify and distinguish differences between normal heartbeats and abnormal heartbeats . Alickovic proposed an autoregressive model in the feature extraction module for diagnosing heart diseases . After the step of feature extraction of ECG signals, classification is traditionally conducted using state-of-the-art classifiers such as support vector machines , neural networks , cluster analysis , random forests , optimum-path forest and some other classification tools . R.J. Martis automatically classified five types of ECG beats using HOS features using three layer feed-forward Neural Network and Least Square- Support Vector Machine classifiers . Varatharajan.R presented big data classification approach using LDA with an enhanced SVM method for ECG signals in cloud computing . Yun-Chi Yeh proposed method of analyzing ECG signal to diagnose cardiac arrhythmias utilizing the cluster analysis method, which could accurately classify and distinguish the difference between normal heartbeats and abnormal heartbeats . Taiyong proposed method to classify ECG signals using wavelet packet entropy and random forests following the Association for the Advancement of Medical Instrumentation recommendations and the interpatient scheme . VHC De Albuquerque introduced the Optimum-Path Forest classifier to automatic arrhythmia detection in ECG patterns . In our approach ,we have used SVM for classification purpose. P.Raman proposed an approach for classification of Heart Diseases based on ECG analysis using c-means and SVM Methods . P.Pławiak presentd an innovative research that enables the efficient classification of cardiac disorders based on ECG signal analysis and an evolutionary-neural system . In recent years, deep learning techniques have shown their outstanding performances in pattern recognition applications . Owing to this, researchers and engineers have shifted their attentions on ECG classification studies based on deep learning related techniques. Many scholars have made large amount of efforts on the study of ECG classification using deep learning techniques. In the literature, it have been reported that several methods are effective for ECG arrhythmia classification. Salloum proposed the using of recurrent neural networks to develop an effective solution to identification and authentication in electrocardiogram -based biometrics . Mostayed proposed recurrent neural network which consists of two bi-directional long-short-term-memory layers to detect in ECG signals . Zhang proposed novel patient-specific electrocardiogram classification algorithm based on the recurrent neural networks to learn time correlation from ECG signal samples and to classify ECG beats with different heart rates . Kiranyaz proposed real-time patient-specific ECG classification approach based on the convolutional neural networks, which can be solely used to classify long ECG records of patients . Li proposed based method to realize the classification of typical types of arrhythmia signals, i.e., normal, left bundle branch block, right bundle branch block, atrial premature contraction and ventricular premature contraction . Yin proposed an ECG monitoring system integrated with the Impulse Radio Ultra Wideband radar based on CNN . Jun proposed an effective ECG arrhythmia classification method using deep two-dimensional convolutional neural network which recently shows outstanding performance in the field of pattern recognition . Salem proposed an ECG arrhythmia classification method using transfer learning from deep CNN features, and the method was applied in the identification and classification of four ECG patterns . Studies mentioned above show that deep neural network can automatically learn complex representative features directly from the data adaptively so that we can reduce excessive dependencies on manual feature extractions, and create end-to-end learning systems that take ECG signals as input and arrhythmia class prediction as output, while extracting the ‘‘deep features’’ automatically . However, as compared to the traditional classification approaches, DNNs require considerable amount of data as the training set. This problem creates gap between the dataset size and deep features, since the datasets that are publicly available in this domain lack in volume . In this paper, we propose an ECG arrhythmia classification method based on deep two-dimensional convolutional neural network on classification of five different rhythms. The input one-dimensional ECG signals in the time domain signals are transformed into two-dimensional time-frequency spectrograms. Nevertheless, in this step noise filtering and manual feature extraction are no longer required. In addition, training data are obtained through augmenting of the derived ECG images, which can result in higher classification accuracy. The segmented time-frequency spectrograms are fed as input of the convolutional neural network. The CNN model can automatically suppress the measurement noises and extract relevant feature maps throughout the convolutional and pooling layer intelligently. Thus, the propose method can be applied to the ECG signals from various ECG acquisition devices with different sampling rates, and it is beneficial in precise identifications of ECG arrhythmia . In all, the proposed ECG arrhythmia classification method consists of the following steps, e.g., ECG signals data acquisition, ECG signals pre-processing, and classifier. The rest of this paper is organized as below. In Section we explain the used for the ECG arrhythmia classification, including ECG data pre-processing, and convolutional neural network classifier. In Section Numerical evaluation and experimental results of ECG arrhythmia classification are shown. In Section we give some discussions and major conclusions of the paper. II. METHODOLOGY A. METHOD OVERVIEW The overall procedures of the proposed ECG arrhythmia classification model is shown in Figure . The original ECG signals were shared the MIT-BIH arrhythmia database . The input ECG signals were divided into data recordings with an identical duration of seconds. The one-dimensional ECG time domain signals, there are five different classes of arrhythmia, based on the recordings annotations which made two or more independently. Afterward, each ECG signal record is transformed into an image of time-frequency spectrogram using the short time Fourier transform . The ECG spectrogram images are fed into the proposed deep two-dimensional convolutional neural network model. With these obtained ECG spectrogram images, classification of the five ECG types is performed in the classifier automatically and intelligently. The five ECG types are normal beat , left bundle branch block beat , right bundle branch block beat , premature ventricular contraction beat , atrial premature contraction beat . B. DATA ACQUISITION AND SELECTION In this subsection, we conducted experimental analysis in order to evaluate the performance of the proposed method. Five types of ECG signals, of which the sampling rate was uniformly set as Hz, were obtained from the MIT-BIH arrhythmia database . The original ECG signal data contains heartbeat information of patients with cardiovascular disease, and each record of the ECG signal contains hour excerpts of two-channel ambulatory recordings. For each type of the ECG signal, segment of seconds were selected. Furthermore, the signals were divided into samples for ECG classification. The related information of the employed data from the MIT-BIH arrhythmia database is listed in Table. Samples of NOR were obtained from records and . Samples of LBB were derived from records and . Samples of RBB were obtained from records and . Samples of APC were obtained from records and . For the above four types, Each type of ECG signals has samples for the training set and samples for the testing set. Samples of PVC were obtained from records and . The type of PVC has samples for the training set and samples for the testing set. Waveforms of the ECG signals are shown in Figure . C. ECG DATA PRE-PROCESSING Within the proposed the input data is required to be of the type of image. Therefore, the ECG signals in the time domain, which belong to five heart disease types, were firstly transformed into time-frequency spectrograms using short-time Fourier transform . The ECG signal is nonstationary data which instantaneous frequency varies according to the time. Therefore, the properties of the changes cannot be fully described merely using information in the frequency domain. The STFT is an enhanced mathematical derived from the discrete Fourier transform , to explore the instantaneous frequency as well as the instantaneous amplitude of localized waves with time-varying characteristics. In the analysis of non-stationary signal, it is assumed that it is approximately stationary within the span of temporal window of finite support . For discretized digital signal, its time-frequency spectrogram is given as STFT ∞  where represents the ECG signal which sampling rate was Hz, and is the window function. In this proposed method, we adopt the Hanning window, whose definition is given as below. And the window size is . Therefore, we transformed ECG time domain signals into ECG spectrums images plotting each ECG data recording as an individual pixel image. sample of each class’s spectrogram is shown in Figure . D. ECG ARRHYTHMIA CLASSIFIER In this paper, CNN is adopted as the ECG arrhythmia classifier. CNN was first introduced LeCun and was developed through project to recognize handwritten zip codes. With the advent of the CNN model, correlation of spatially adjacent pixels can be extracted applying nonlinear filter and applying multiple filters, and it is capable of extracting various local features of the image.  convolutional and pooling layers are more suitable for filtering the spatial locality of ECG images . Therefore, to facilitate in ECG signal classification, we convert ECG signals in the time domain into spectrograms in time-frequency representations. The structure of the is illustrated in Figure . The explanations for the applied functions in the model are shown in Table . Firstly, each ECG data recording was transformed into an ECG spectrums images which size is pixel. In the first hidden layer, the layer with convolution kernels and the kernels size of was applied, and the activation function we choose is RELU . Afterwards, which pool size is was added. Then, the output shape of the first Layer is . In the second hidden layer, the layer with convolution kernels and the kernels size of was applied, and the activation function is RELU. Then, with the pool size of was added, and the output shape of the second layer is . In the third hidden layer, the layer with convolution kernels and the kernels size of was applied, and the activation function is RELU. Next, with the pool size of was added, and the output shape of the third Layer is finally. III. RESULTS A. EVALUATION METRICS In this section, we attempt to evaluate the classification performance using two metrics, e.g., the accuracy and the loss. The indicator of the accuracy is the ratio between the number of correctly classified samples and that of the whole test samples. Its mathematical expression is defined as Accuracy TP TN TP TN FP FN where TP stands for true positive, meaning the correct classification as arrhythmia; TN stands for true negative, meaning correct classification as normal; FP stands for false positive, meaning incorrect classification as arrhythmia; FN represents false negative, meaning incorrect classification as normal . As for the metric of loss, it is defined as the difference between the predicted value of the model and the true value for specific sample. This metric has several distinct types of mathematical expressions. In this study, we choose the function of categorical cross entropy loss. . . . ˆyim yim, where represents the number of samples; represents the number of categories; represents the predictive output value; and represents the actual value. B. MODEL PARAMETER OPTIMIZATION In this proposed model, there are two main parameters, that is, the learning rate and the batch size. In order to achieve the best classification performance of ECG heart rhythm abnormalities, the step of model parameter optimization is indispensable. To evaluate the importance of the learning rate and the batch size within the proposed model, series of contrast experiments with different parameter sets were conducted. On one hand, we tested the contrast experiments with different learning rates when keeping the value of the batch size unchanged. The detailed parameter set is shown in Table . On the other hand, we attempted the contrast experiments with different batch sizes when keeping the value of the learning rate unchanged. The detailed parameter sets are shown in Table . We set the number of iteration steps as . Figure represents the accuracy value curves for the data sets with the batch size of . Table shows the average accuracies for the data sets. From the figures above, we can find that with the same batch size parameters, the average accuracies of the data sets are similar. However, the accuracy curve shows different fluctuation at different learning rates. When the learning rate is as the number of iteration steps increases, the accuracy curve exhibits convergence trend close to the value of and it maintains relatively stable state during convergence. When the learning rate is as the number of iteration steps increases, the accuracy curve still exhibits convergence trend, but several relatively large fluctuations are found during the process of convergence. As the value of the learning rate parameter increases from to the fluctuation during the convergence process of the accuracy curve becomes larger. Figure shows the loss value curves for the data sets with the Batch Size of . Table shows the average losses for the data sets. From the illustrations above we can find that with the same batch size parameters of the average losses of the data sets are similar. However, at different learning rates, the loss curve shows different fluctuation. When the learning rate is as the number of iteration steps increases, the accuracy curve exhibits convergence trend close to the value of and it maintains relatively stable state during convergence. When the learning rate is as the number of iteration steps increases, the loss curve still exhibits convergence trend, but there are several relatively large fluctuations in the process of convergence. As the learning rate parameter increases from to the fluctuations during the convergence of the loss curve become larger. Table shows detailed parameter set for the contrast experiments with different parameters of batch size when keeping the value of the learning rate unchanged. Figure represents the accuracy value curves for the data sets with common learning rate of . Table shows the average accuracies for the data sets. From the illustrations above we can find that with the same learning rate parameters, the average accuracies of the data sets are similar. However, the accuracy curve shows different fluctuation at different batch sizes. When the batch size is as the number of iteration steps increases, the accuracy curve exhibits convergence trend close to the value of and it maintains relatively stable state during convergence. When the batch size is set as as the number of iteration steps increases, the accuracy curve still exhibits convergence trend, but there are several relatively large fluctuations in the process of convergence. With the batch size parameter gradually decreased, from to the fluctuations during the convergence of the accuracy curve become larger. Figure represents the loss value curves for the data sets with common learning rate of . Table shows the average losses for the data sets. From the illustrations above we can find that with the same parameter of the learning rate, the average losses of the data sets are similar. However, the loss curve shows different fluctuation at different batch sizes. When the batch size is set as as the number of iteration steps increases, the loss curve exhibits convergence trend close to the value of and maintains relatively stable state during convergence. When the batch size is as the number of iteration steps increases, the loss curve still exhibits convergence trend, but there are several relatively large fluctuations in the process of convergence. With the batch size parameter gradually decreased, from to the fluctuation during the convergence of the accuracy curve becomes larger. From the experimental comparisons demonstrated above, we can conclude that when the learning rate is and the batch size parameter is the model show the best accuracy as well as the lowest loss. In addition, the accuracy curve and the loss curve show the best convergence performance. C. COMPARISON WITH MODEL In this subsection, we show contrast experiment between the model and the proposed . In the model, the learning rate is and the batch size parameter is . Evaluation results of model and the proposed are summarized in Table . From the table, we can find that the model achieved an average accuracy of and an average loss of . In contrast, the proposed model achieved an average accuracy of and an average loss of . Figure represents the accuracy value curves of the and the proposed . From the graphs above we can find that, with the same learning rate and batch size, the accuracy value curve convergence rate of the proposed model is faster than that of model, and the final accuracy convergence value of model is also much higher than that of model. Figure represents the loss value curves of the and that of the proposed . From this figure, we can observe that the loss value curve convergence rate of the proposed model is faster than that of model, and the final loss convergence value of model is also much lower than that of model From these results, we can conclude that the proposed model achieves higher average accuracy with lower loss than the model based on the classification results of five different arrhythmia types. The proposed model outperforms the model in the ECG arrhythmia classification application. D. COMPARISON WITH OTHER EXISTING APPROACHES We compared the performance of the proposed model with previous ECG arrhythmia classification works, including SVM , RNN , RF , K-NN . Since these works have different number of the test set and types of arrhythmia, it is unfair to directly compared with accuracy itself. However, our proposed CNN model achieved successful performance compared to other previous works while introducing the different approach of classifying ECG arrhythmia using STFT-based spectrogram and convolutional neural network. Table presents performance comparison with previous works. From the Table we can find that the proposed method achieved the best results in average accuracy. We also compared the classification performance of the proposed model with feature extraction–pattern classification approaches. From the TABLE we can observe that the classification accuracy of the two featureextraction–pattern classification approach is similar to that of the proposed method in this paper. Maya Kallas used Kernel Principal Component Analysis for feature extraction of ECG signals, and apply the Support Vector Machines classification, to diagnose heartbeat abnormalities . Qibin Zhao used the wavelet transform and autoregressive modelling to extract the features of each ECG segment, and the support vector machine with Gaussian kernel is used to classify different ECG heart rhythm . The two featureextraction–pattern classification approaches are comprised of three components including data preprocessing, feature extraction and classification of ECG signals. Compared with the proposed classifier, the feature-extraction processing of feature-extraction-pattern approaches is much more complex. The confusion matrix for the final result in the proposed classifier is shown in Fig. . IV. CONCLUSION In this paper, we proposed an ECG arrhythmia classification method based on deep learning techniques. ECG signals, belonging to five different types, were obtained from the MIT-BIH arrhythmia database. The ECG signals were segmented into records of the duration of seconds.  records were selected for ECG classification. In the procedure of the proposed method, the ECG signals in the time domain were transformed into two-dimensional time-frequency ECG spectrograms short-time Fourier transform. The resultant ECG spectrograms were used as input to the proposed method. The ECG arrhythmia was identified and classified using the CNN. The results show that the classification of ECG signals based on two-dimensional convolution neural network can reach an averaged accuracy of . In addition, in order to achieve the best classification performance, series of contrast experiments with different parameter sets were made. We found that the classifier based on the proposed model has the highest accuracy and the lowest loss when the learning rate is and the batch size is . Finally, we compared the performance of the proposed model with that of the model. ECG recordings of five arrhythmia types, shared the MIT-BIH arrhythmia database, were utilized for evaluations of the classification performance. As result, the classifier achieved an averaged accuracy of while the classifier achieved an averaged accuracy of . The ECG arrhythmia classification experimental results have successfully validated that the proposed can achieve better classification accuracy without manual pre-processing of the ECG signals such as noise filtering, feature extraction, and feature reduction.