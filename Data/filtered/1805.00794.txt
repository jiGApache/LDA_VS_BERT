 Electrocardiogram can be reliably used as measure to monitor the functionality of the cardiovascular system. Recently, there has been great attention towards accurate categorization of heartbeats. While there are many commonalities between different ECG conditions, the focus of most studies has been classifying set of conditions on dataset annotated for that task rather than learning and employing transferable knowledge between different tasks. In this paper, we propose method based on deep convolutional neural networks for the classification of heartbeats which is able to accurately classify five different arrhythmias in accordance with the AAMI standard. Furthermore, we suggest method for transferring the knowledge acquired on this task to the myocardial infarction classification task. We evaluated the proposed method on PhysionNetâ€™s MIT-BIH and PTB Diagnostics datasets. According to the results, the suggested method is able to make predictions with the average accuracies of and on arrhythmia classification and MI classification, respectively. Index Terms ECG, deep learning, transfer learning, heartbeat, myocardial infraction I. INTRODUCTION ECG is widely used and medical practitioners for monitoring the cardiac health. The main problem with manual analysis of ECG signals, similar to many other time-series data, lies in difficulty of detecting and categorizing different waveforms and in the signal. For human, this task is both extensively time-consuming and prone to errors. Note that the proper diagnosis of cardiovascular diseases is of paramount importance since these are the cause of death for about one-third of all deaths around the globe . For instance, millions of people experience irregular heartbeats which can be lethal in some cases. Therefore, accurate and low-cost diagnosis of arrhythmic heartbeats is highly desirable . To address the problems raised with the manual analysis of ECG signals, many studies in the literature explored using machine learning techniques to accurately detect the anomalies in the signal , . Most of these approaches involve preprocessing phase for preparing the signal . Afterwards, the handcrafted features which are mostly statistical summarizations of signal windows are extracted from these signals and used in further analysis for the final classification task. As for the inference engine, conventional machine learning approaches for ECG analysis include Support Vector Machines, multi-layer perceptrons, decision trees, etc. , , These handcrafted features provide us with an acceptable representation of the signal, based on recent machine learning studies, automated feature extraction and representation methods are proven to be more scalable and are capable of making more accurate predictions. An end-to-end deep learning framework allows the machine to learn the features that are best suited to the specific task that it is dedicated to carry out , , . This approach provides us with more accurate representation of ECG signal using which the machine can compete with human in analyzing the signal . Deep learning approaches, however, contain tremendously large amount of variables which require massive amounts of data to be trained. One way of dealing with the need to massive amount of data is the concept of knowledge transfer between different tasks. In computer vision, as an example, ImageNet dataset along with the state of the art deep learning models have been used to transfer knowledge between different image understanding tasks . As another example, it has been shown that different sentence categorization tasks can share considerable amount of sentence understanding . On the other hand, there has been uses of transfer learning in health informatics. For example, Alaa et al. have used the parameters of Gaussian expert process trained on patients with stable conditions for patients with deteriorating conditions. In this paper, we propose novel framework for ECG analysis that is able to represent the signal in way that is transferable between different tasks. For this to happen, we describe deep neural network architecture which offers considerable capacity for learning such representations. This network has been trained on the task of arrhythmia detection for learning which it is plausible to assume that the model needs to learn most of the shape-related features of the ECG signal. Also, we have large amount of labeled data for this task, which makes it easy to train network with large amount of parameters. Furthermore, we show that the signal representation learned from this task is successfully transferable to the task MI prediction using ECG signals. This method allows us to use these deep representations to share knowledge between ECG recognition tasks for which enough information may not be available for training deep architecture. The rest of this paper is organized as follows. Section II explains the datasets used in this study. Section III presents the proposed method. Section IV presents results of the suggested method on different task and comparison of them with other works in the literature. Finally, Section concludes the paper. II. DATASETS In this paper, we use PhysioNet MIT-BIH Arrhythmia and PTB Diagnostic ECG Databases as data source for labeled ECG records , , . Furthermore, we demonstrate that the knowledge learned from the former database can be successfully transferred for training inference models for the latter. In all of our experiments, we have used ECG lead II re-sampled to the sampling frequency of as the input. The MIT-BIH dataset consists of ECG recordings from different subjects recorded at the sampling rate of . Each beat is annotated at least two We use annotations in this dataset to create five different beat categories in accordance with Association for the Advancement of Medical Instrumentation standard . See Table for summary of mappings between beat annotations in each category. The PTB Diagnostics dataset consists of ECG records from subjects . Each record contains ECG signals from leads sampled at the frequency of . In this study we have only used ECG lead II, and worked with MI and healthy control categories in our analyses. III. METHODOLOGY A. Preprocessing As ECG beats are inputs of the proposed method we suggest simple and yet effective method for preprocessing ECG signals and extracting beats. The steps used for extracting beats from an ECG signal are as follows .  Normalizing the amplitude values to the range of between zero and one.  Finding the set of all local maximums based on zerocrossings of the first derivative.  Finding the set of ECG R-peak candidates applying threshold of on the normalized value of the local maximums.  Finding the median of R-R time intervals as the nominal heartbeat period of that window .  For each R-peak, selecting signal part with the length equal to .  Padding each selected part with zeros to make its length equal to predefined fixed length. It is worth mentioning that the suggested beat extraction method is simple and effective in extracting R-R intervals from signals with different For example, we have not used any form of filtering or any processing that makes any assumption about the signal or spectrum. Additionally, all the extracted beats have identical lengths which is essential for being used as inputs to the subsequent processing parts. B. Training the Arrhythmia Classifier In this paper we suggest training convolutional neural network for classification of ECG beat types on the MIT-BIH dataset. The trained network not only can be used for the purpose of beat classification, but also in the next section we show that it can be used as an informative representation of heartbeats. Fig. illustrates the network architecture proposed for the beat classification task. Extracted beats, as explained in Section III-A, are used as inputs. Here, all convolution layers are applying convolution through time and each have kernels of size . We also use max pooling of size and stride in all pooling layers. The predictor network consists of five residual blocks followed two fully-connected layers with neurons each and softmax layer to predict output class probabilities. Each residual block contains two convolutional layers, two ReLU nonlinearities , residual skip connection , and pooling layer. In total, the resulting network is deep network consisting of weight layers. C. Training the MI Predictor After training the network suggested in Section III-B, we use the output activations of the very last convolution layer as representation of input beats. Here, we use this representation as input to two layer fully-connected network with neurons at each layer to predict MI. It is noteworthy to mention that during the training for the MI prediction task, we freeze the weights for all other layers aside from the last two. In other words, we only train the last two network layers and use the learned representation of Section III-B. D. Implementation Details In all experiments, TensorFlow computational library is used for model training and evaluation. Cross entropy loss on the softmax outputs is used as the loss function. For training the networks, we used Adam optimization method with the learning rate, and of and respectively. Learning rate is decayed exponentially with the decay factor of every iterations. Training all the networks took less than two hours on GeForce GTX processor. IV. RESULTS A. Arrhythmia Classification and learning the representation We evaluated the arrhythmia classifier of Section III-B on heartbeats that are not used in the network training phase. Note that the dataset is being augmented to reach balance in the number of beats in each category. Fig. presents the confusion matrix of applying the classifier on the test set. As it can be seen from this figure, the model is able to make accurate predictions and distinguish different classes. Table II presents the average accuracy of the proposed method and compares it with other relevant methods in the literature. While suggesting predictor for MIT-BIH is not the sole purpose of this study, according to the results, the accuracies achieved in this paper are competitive to the state of the art methods. The main reason behind this might be the fact that we have used residual connections in our network architecture which allows us to train deeper networks compared to using traditional convolutional architectures. B. MI Classification using the learned representation We have trained our MI predictor using the learned representations, and took of the PTB dataset as our training set. We have used the remaining to test our model. Table III presents comparison between the average accuracy, precision, and recall of the proposed method for MI classification and other work in the literature. The performance of the proposed method is better than all other works except the method suggested Sharma et al. that reports higher accuracy and precision values. However, it noteworthy to mention that Sharma et al. use ECG as opposed to us using only the lead II. C. Visualization of the learned representation In order to visualize the learned representation, we have used t-SNE visualization method to map highdimensional vector created the last convolutional layer to the space. In nutshell, t-SNE creates mapping such that the joint probability of data-points appearing close to each other in the high-dimensional space is similar to the same probability distribution in the low-dimensional mapped points. Fig. illustrates the visualization of the learned representation on the MIT-BIH dataset samples. As it can be seen from this figure, data-points from different classes are easily separable using the learned representation. Fig. shows the visualization of the MI classification task on the PTB samples using the representation trained on MIT-BIH. It can be inferred from this figure that the transferred representation for the beat classification task is able to provide reasonable separation for the MI classification task. It should be noted that here we only use class labels to colorize the plots and other than this we do not use sample labels in the visualizations. V. CONCLUSION In this study we have presented method for ECG heartbeat classification based on transferable representation. Specifically, we have trained deep convolutional neural network with residual connections for the arrhythmia classification task and shown that the representation learned for this task can be used as base to train accurate classifiers for the classification of MI. According to the results, the suggested method is able to make predictions on both tasks with accuracies comparable to the state of the art methods in the literature. Furthermore, we visualized the learned representation using t-SNE method and illustrated the effectiveness of the proposed approach.