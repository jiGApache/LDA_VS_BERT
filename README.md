# Topic modeling: BERT vs LDA

## Описание проекта

Целью данного проекта является сравнение двух подходов для решения задачи тематического моделирования научных статей: BERT и LDA. 
Сравнение двух моделей будет происходить путем сравнения **Coherence Score** каждой модели - метрики, которая оценивает, насколько связными являются слова в каждом топике. Более высокий показатель свидетельствует о более связных и интерпретируемых топиках.

### LDA
Для реализации модели LDA используется готовая модель из библиотеки ```gensim```, которая помимо этого предоставляет различные  инструменты для создания корпусов текстовых документов и  препроцессинга текстов.

### BERT
Для реализации тематического моделирования с помощью модели BERT исопльзуется готовая библиотека BERTopic, которая в своей основе имеет ряд ключевых компонентов:
- предобученная модель [sentence-transformer](https://www.sbert.net/) для вычисления эмбеддингов предложений текста
- алгоритм UMAP для уменьшения размерности полученных эмбеддингов предложений
- модель HDBSCAN для кластеризации полученных эмбеддингов
- Выделение топиков из каждого полученного кластера при помощи техники c-TF-IDF

## Используемые данные
### Описание
В качестве исходных данных были использованы 10 научных [статей](#источники) из смежных областей. Примерное распределение тем в каждой статье можно увидеть в следующей таблице:
№ Статьи | Few-Shot | Time Series | Siamese Network | Medicine | Convolutioinal Networks 
--- | :---: | :---: | :---: | :---: | :---:
1  | + | | + | | +
2  | | + | | + | +
3  | | | + | | +
4  | + | | | | +
5  | + | + | | + | +
6  | | | + | + | +
7  | + | + | + | + | + 
8  | | | | + | +
9  | | | | + | +
10  | + | | + | | +

### Предобработка данных
В качестве предварительной обработки исходных текстов были проведены следующие действия:
- Удаление частей статей, находящихся перед заголовком "Abstract" и после "References"
- Удаление подписей к рисункам и таблицам
- Восстановление переносов слов и разрывов предложений
- Удаление содержимого всех скобок, а также всех математических выражений (формул, отдельных переменных и операторов, чисел и т.д.)
- Удаление повторяющихся пробелов, коротких предложений и знаков препинания (за исключением знака конца предложения)
- Удаление "стоп" слов и стемминг

После этого на вход модели BERTopic подавался список предложений из всех текстов, а LDA - список отдельно токенизированных текстов.

## Результаты

### LDA

После запуска модели были получены следующие результаты:
```
[(0, '0.029*"time" + 0.024*"use" + 0.022*"seri" + 0.022*"ecg"'),
 (1, '0.023*"train" + 0.023*"loss" + 0.020*"use" + 0.020*"test"'),
 (2, '0.064*"learn" + 0.025*"network" + 0.024*"data" + 0.022*"few-shot"'),
 (3, '0.024*"set" + 0.016*"train" + 0.016*"class" + 0.016*"data"'),
 (4, '0.018*"use" + 0.018*"similar" + 0.016*"network" + 0.014*"learn"'),
 (5, '0.035*"class" + 0.034*"use" + 0.031*"dataset" + 0.018*"imag"'),
 (6, '0.032*"ecg" + 0.022*"propos" + 0.021*"work" + 0.018*"detect"'),
 (7, '0.024*"time" + 0.016*"seri" + 0.014*"number" + 0.013*"train"'),
 (8, '0.026*"accuraci" + 0.022*"result" + 0.020*"method" + 0.019*"model"'),
 (9, '0.037*"ecg" + 0.037*"layer" + 0.027*"convolut" + 0.024*"signal"')]
Coherence score: 0.5813482944604764
  ```
  Среди полученных топиков можно рассмотреть, что выделяются темы, предположительно связанные с:
  - временными рядами ЭКГ
  - процессом обучения нейронных сетей
  - обработкой ЭКГ сверточными сетями
  - подходом Few-Shot
  - и др.

### BERTopic

Поскольку преобразования, получаемые алгоритмом UMAP недетерминированны, то результаты работы модели могут отличаться от запуска к запуску. Для демонстрации работы модели ниже представлены результаты, полученные после нескольких запусков:

![Alt text](https://github.com/jiGApache/LDA_VS_BERT/raw/main/images/1.png)
```Coherence score: 0.6678060705895651```

![Alt text](https://github.com/jiGApache/LDA_VS_BERT/raw/main/images/2.png)
```Coherence score: 0.6523510109581216```

На основе полученных диаграмм можно предположить, что:
- были получены все основные топики, содержащиеся в анализируемых статьях (Few-Shot, Time Series, Siamese Networks, Medicine, Convolutional Networks)
- были получены топики, характеризующие наполнение статей (сравнение результатов, описание данных, и т.д.)
- получены топики в смежных и не обозначенных в начале темах (анализ данных ЭКГ сверточными сетями, применение подходов глубоких нейронных сетей, трансферное обучение)
  

## Выводы

Можно сказать, что оба подхода в определенной степени справляются с решением задачи тематического моделирования научных статей.

Однако, при сравнении полученных метрик **Coherence Score** каждой из модели, модель LDA проявила себя чем BERTopic.

Это косвенно подтверждается при визуальном анализе результатов: полученные с ее помощью топики не смогли выделить характерные темы каждой статьи в полной мере - в них перемешаны ключевые слова из нескольких базовых тем и они плохо поддаются интерпретации.

В то же время модель BERTopic смогла выделить как все основные темы, присущие статьям, так и выделить несколько топиков, включающих в себя основные темы. Более того, были выделены топики, которые не удалось обозначить при предварительной оценке статей.

## Источники
1. Few-Shot Learning Through an Information Retrieval Lens - https://arxiv.org/abs/1707.02610
2. ECG Heartbeat Classification: A Deep Transferable Representation - https://arxiv.org/pdf/1805.00794.pdf
3. Fully Convolutional Siamese Networks for Change Detection - https://arxiv.org/abs/1810.08462
4. Meta-Transfer Learning for Few-Shot Learning - https://arxiv.org/abs/1812.02391
5. Meta-Learning for Few-Shot Time Series Classification - https://arxiv.org/abs/1909.07155
6. EDITH : ECG biometrics aided by Deep learning for reliable Individual auTHentication - https://arxiv.org/abs/2102.08026
7. Similarity Learning based Few Shot Learning for ECG Time Series Classification - https://ieeexplore.ieee.org/document/9647357
8. Automated Detection of Arrhythmias Using Different Intervals of Tachycardia ECG Segments with Convolutional Neural Network - https://www.researchgate.net/publication/315821873_Automated_Detection_of_Arrhythmias_Using_Different_Intervals_of_Tachycardia_ECG_Segments_with_Convolutional_Neural_Network
9. ECG Arrhythmia Classification Using STFT-Based Spectrogram and Convolutional Neural Network - https://ieeexplore.ieee.org/document/8759878
10. Siamese Neural Networks for One-shot Image Recognition - https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf
